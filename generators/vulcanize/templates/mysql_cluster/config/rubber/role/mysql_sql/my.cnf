<%
  @path = "/etc/mysql/my.cnf"
  
  # When sql nodes on same hosts as data nodes, then this config needs to be
  # additive - the mysql_data node gets generated first due to generator order
  self_instance = rubber_instances[rubber_env.host]
  if self_instance.role_names.include?('mysql_data')
    @additive = ['# mysql_sql start', '# mysql_sql end']
  end
  
  mgm_nodes = rubber_instances.for_role('mysql_mgm')
  mgm_host = mgm_nodes.first.full_name
%>

# Generated by rubber for mysql_sql role

[client]
default-character-set = utf8

[mysqld]
default-character-set = utf8
ndbcluster
ndb-connectstring=<%= mgm_host %>
