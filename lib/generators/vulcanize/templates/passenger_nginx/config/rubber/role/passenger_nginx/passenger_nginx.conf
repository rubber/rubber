<%
  @path = "/etc/nginx/rubber/passenger_nginx.conf"
%>        
  # This server is setup to serve www.
  server
  {
    listen <%= rubber_env.passenger_listen_port %>;
		passenger_enabled on;

    server_name <%= rubber_env.domain %>;

    root <%= RUBBER_ROOT + "/public" %>;

    # this rewrites all the requests to the maintenance.html
    # page if it exists in the doc root. This is for capistrano's
    # disable web task
    if (-f $document_root/system/maintenance.html)
    {
      rewrite  ^(.*)$  /system/maintenance.html last;
      break;
    }

    error_page   500 502 503 504  /500.html;
    location = /500.html
    {
      root <%= RUBBER_ROOT + "/public" %>;
    }
    error_page 404  /404.html;
    location = /404.html
    {
      root <%= RUBBER_ROOT + "/public" %>;
    }
  }

